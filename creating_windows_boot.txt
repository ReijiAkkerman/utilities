При создании загрузочной флешки Windows
по старому методу методу, а именно через UltraISO - 
возникает ошибка форматирования в NTFS.
Почему именно она возникает я могу только догадываться, 
однако для создания загрузочной флешки нужно учитывать 
следующее.

Линукс дистрибутивы можно записывать напрямую на диск игнорируя
разделы носителя и их файловую систему через утилиту dd,
однако Windows по каким-то закулисным причинам должен 
записываться не на диск а именно на раздел диска форматированный 
в поддерживаемый UEFI формат.

Большинство компьютеров на данный момент оснащаются UEFI,
а не BIOS как раньше.

UEFI работает только с файловой системой FAT32 которая
способна записывать файлы объемом не более 4ГБ,
а на сегодняшний день даже образ Windows 10 содержит 
файл install.wim который весит 44хх MB - то есть 
больше допустимого значения FAT32.

Для записи образа нужна программа UNetbootin

установить ее можно через apt менеджер

sudo add-apt-repository ppa:gezakovacs/ppa
sudo apt-get update
sudo apt-get install unetbootin

есть готовые бинарники - их я положил в том же каталоге 
что и этот файл, однако для работы бинарника нужны права на 
его исполнение chmod +x

также можно скомпилировать вручную архив с исходниками программы 
лежит тут же

Теперь когда есть ЧЕМ записывать образ нужно подготовить то 
ЧТО мы будем записывать 

Я использовал образ Windows 10 скачанный с официального сайта
в 2021 году, на сегодняшний же день в связи с сакциями доступ 
к образу может быть ограничен с российских IP адресов, 
для обхода блокировки попробуйте использовать VPN.

Так как основной проблемой при записи образа является 
слишком большой размер файла install.wim - 
то необходимо порезать его на куски объемом менее 4ГБ,
причем так чтобы установочник Windows знал что этот файл не один
и попытался найти другие чтобы правильно завершить установку.
К счастью разработчики windows создали формат .swm 
который сообщает установочнику windows о том что необходимый
для полноценной установки файл не один.

Для того чтобы порезать на куски файл install.wim я использовал 
библиотеку wimlib исходники которой в виде архива я разместил 
рядом с этим файлом.

Можно конечно скомпилировать программу, но я ленивый 
так что просто установил всё через apt менеджер 

(команда не точная, пишу о том как создать загрузочную флешку 
по открытым ссылкам в браузере оставшимся после создания флешки
и по памяти)

sudo apt install wimtools

Итак, теперь когда всё для создания нужного ISOшника готово - 
начинаем работу.

Извлекаем файлы из ISO образа Windows который скачали
в папку (я назвал папку "win10"). Извлекал файлы я с помощью
встроенного в Ubuntu 22.04 менеджера файлов.

перехожу в папку win10/source с помощью команды cd.

Теперь нужно порезать файл unstall.wim 

wimsplit install.wim install.swm 3700

wimsplit - аналог wimlib-imagex split
install.wim - файл который нужно разделить
install.swm - файл который получится после разделения
    причем последующие файлы будут иметь наименования 
    install2.swm, install3.swm и т.д. в зависимости от того
    сколько файлов выйдет в итоге
3700 - размер в мегабайтах который я указал

У меня получились на выходе файлы install.swm и install2.swm.
Естественно программа только лишь делит эти файлы - сам исходный 
файл она не трогает. Исходник нужно удалить - если этого
не сделать во время записи образа на флешку запишутся и
install.wim причем с ошибкой и install.swm, install2.swm - 
а уже во время установки установочник windows сперва будет
искать файл install.wim, который он найдет и попытается запустить.
Но то что он нашел не записано полностью из-за ограничения 
в 4ГБ а так как основной файл он по сути нашел то пытаться
искать файлы с расширением .swm он уже не будет и выдаст ошибку 
о неправильно подготовленном образе.

Теперь когда мы имеем все необходимые файлы нужного размера - 
нужно создать ISO образ который мы будем записывать на флешку.

Это можно сделать как с помощью dd так и с помощью genisoimage,
последний вроде устанавливается через apt менеджер.

Я использовал genisoimage - для этого выходим из папки win10
и вводим в терминал следующее

genisoimage -o win10.iso win10 (можно и ./win10)

ждём пока образ соберется

После сборки образа записываем его на флешку

Перед форматированием я с помощью утилиты fdisk
создал таблицу разделов GPT на флешке и задал загрузочный флаг 

форматировал созданный с помощью fdisk на флешке раздел командой
mkfs.vfat в FAT32

Флешка готова к записи, однако у меня когда я записал на флешку 
образ win10.iso он почему-то не стал устанавливаться 
(какая там была ошибка уже не помню но не та что выходила 
когда записывался исходный образ)

Для решения этой проблемы я записал на флешку исходный образ,
потом поверх записанного образа записал измененный образ 
разрешив перезапись файлов с таким же именем. Как итог - 
у меня на флешке в папке source имеется как install.wim так и 
install.swm и его производные 

перейдя в папку source я удалил ошибочный файл install.wim

sudo rm -f install.wim

В теории можно не перезаписывать поверх исходного образа - образ 
wim10.iso, а вместо этого просто зайти в каталог win10/source
и оттуда скопировать на флешку файлы с расширением .swm,
а install.wim из флешки удалить командой выше. Но я не проверял.

Для копирования 

sudo cp *.swm <папка_монтирования_флешки>/source

Отключаем флешку от системы и она готова к использованию.